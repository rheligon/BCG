/**
 * jQuery Form Validation
 * Copyright (C) 2015 RunningCoder.org
 * Licensed under the MIT license
 *
 * @author Tom Bertrand
 * @version 1.5.0 (2015-02-08)
 * @link http://www.runningcoder.org/jqueryvalidation/
 *
 * @note
 * Remove debug code: //\s?\{debug\}[\s\S]*?\{/debug\}
 */
(function(window,document,$,undefined){function _buildRegexFromString(e){function u(){}if(!e||typeof e!=="string"&&!(e instanceof RegExp)){u();return false}if(typeof e!=="string"){e=e.toString()}var t=e.charAt(0),n=e.length-1,r,i,s;while(n>0){if(/[gimsxeU]/.test(e.charAt(n))){n--}else{break}}if(e.charAt(n)!==t){t=null}if(t&&n!==e.length-1){i=e.substr(n+1,e.length-1)}if(t){r=e.substr(1,n-1)}else{r=e}try{s=new RegExp(r,i)}catch(o){u();return false}return s}window.Validation={form:[],labels:{},hasScrolled:false};if(typeof Object.preventExtensions!=="function"){Object.preventExtensions=function(e){return e}}var _rules={NOTEMPTY:/./,INTEGER:/^\d+$/,NUMERIC:/^\d+(?:[,|\s]\d{3})?(?:\.\d+)?$/,MIXED:/^[\w\s-]+$/,NOSPACE:/^(?!\s)\S*$/,TRIM:/^[^\s].*[^\s]$/,DATE:/^\d{4}-\d{2}-\d{2}(\s\d{2}:\d{2}(:\d{2})?)?$/,EMAIL:/^([^@]+?)@(([a-z0-9]-*)*[a-z0-9]+\.)+([a-z0-9]+)$/i,URL:/^(https?:\/\/)?((([a-z0-9]-*)*[a-z0-9]+\.?)*([a-z0-9]+))(\/[\w?=\.-]*)*$/,PHONE:/^(\()?\d{3}(\))?(-|\s)?\d{3}(-|\s)\d{4}$/,OPTIONAL:/^.*$/,COMPARISON:/^\s*([LV])\s*([<>]=?|==|!=)\s*([^<>=!]+?)\s*$/},_messages={"default":"$ contain error(s).",NOTEMPTY:"$ must not be empty.",NUMERIC:"$ must be numeric.",INTEGER:"$ must be an integer.",STRING:"$ must be a string.",NOSPACE:"$ must not contain spaces.",TRIM:"$ must not start or end with space character.",MIXED:"$ must be letters or numbers (no special characters).",DATE:"$ is not a valid with format YYYY-MM-DD.",EMAIL:"$ is not valid.",URL:"$ is not valid.",PHONE:"$ is not a valid phone number.","<":"$ must be less than % characters.","<=":"$ must be less or equal to % characters.",">":"$ must be greater than % characters.",">=":"$ must be greater or equal to % characters.","==":"$ must be equal to %","!=":"$ must be different than %"},_data={validation:"data-validation",validationMessage:"data-validation-message",regex:"data-validation-regex",regexReverse:"data-validation-regex-reverse",regexMessage:"data-validation-regex-message",group:"data-validation-group",label:"data-validation-label",errorList:"data-error-list"},_options={submit:{settings:{form:null,display:"inline",insertion:"append",allErrors:false,trigger:"click",button:"[type='submit']",errorClass:"error",errorListClass:"error-list",inputContainer:null,clear:"focusin",scrollToError:false},callback:{onInit:null,onValidate:null,onError:null,onBeforeSubmit:null,onSubmit:null,onAfterSubmit:null}},dynamic:{settings:{trigger:null,delay:300},callback:{onSuccess:null,onError:null,onComplete:null}},rules:{},messages:{},labels:{},debug:false},_supported={submit:{settings:{display:["inline","block"],insertion:["append","prepend"],allErrors:[true,false],clear:["focusin","keypress",false],trigger:["click","dblclick","focusout","hover","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","toggle"]}},dynamic:{settings:{trigger:["focusout","keydown","keypress","keyup"]}},debug:[true,false]};var Validation=function(node,options){function extendRules(){options.rules=$.extend(true,{},_rules,options.rules)}function extendMessages(){options.messages=$.extend(true,{},_messages,options.messages)}function extendOptions(){if(!(options instanceof Object)){options={}}var e=Object.preventExtensions($.extend(true,{},_options));for(var t in options){if(!options.hasOwnProperty(t)||t==="debug"){continue}if(~["labels","messages","rules"].indexOf(t)&&options[t]instanceof Object){e[t]=options[t];continue}if(!_options[t]||!(options[t]instanceof Object)){continue}for(var n in options[t]){if(!options[t].hasOwnProperty(n)){continue}if(!_options[t][n]||!(options[t][n]instanceof Object)){continue}for(var r in options[t][n]){if(!options[t][n].hasOwnProperty(r)){continue}if(_supported[t]&&_supported[t][n]&&_supported[t][n][r]&&$.inArray(options[t][n][r],_supported[t][n][r])===-1){delete options[t][n][r]}}if(e[t]&&e[t][n]){e[t][n]=$.extend(Object.preventExtensions(e[t][n]),options[t][n])}}}if(e.dynamic.settings.trigger){if(e.dynamic.settings.trigger==="keypress"&&e.submit.settings.clear==="keypress"){e.dynamic.settings.trigger="keydown"}}options=e}function delegateDynamicValidation(){if(!options.dynamic.settings.trigger){return false}if(!node.find("["+_data.validation+"],["+_data.regex+"]")[0]){return false}var e=options.dynamic.settings.trigger+delegateSuffix;if(options.dynamic.settings.trigger!=="focusout"){e+=" change"+delegateSuffix+" paste"+delegateSuffix}$.each(node.find("["+_data.validation+"],["+_data.regex+"]"),function(t,n){$(n).unbind(e).on(e,function(e){if($(this).is(":disabled")){return false}var t=this,n=e.keyCode||null;_typeWatch(function(){if(!validateInput(t)){displayOneError(t.name);_executeCallback(options.dynamic.callback.onError,[node,t,n,errors[t.name]])}else{_executeCallback(options.dynamic.callback.onSuccess,[node,t,n])}_executeCallback(options.dynamic.callback.onComplete,[node,t,n])},options.dynamic.settings.delay)})})}function delegateValidation(){_executeCallback(options.submit.callback.onInit,[node]);var e=options.submit.settings.trigger+".vd";if(!node.find(options.submit.settings.button)[0]){return false}node.on("submit",false);node.find(options.submit.settings.button).off(".vd").on(e,function(e){e.preventDefault();resetErrors();_executeCallback(options.submit.callback.onValidate,[node]);if(!validateForm()){_executeCallback(options.submit.callback.onError,[node,errors]);displayErrors()}else{_executeCallback(options.submit.callback.onBeforeSubmit,[node]);options.submit.callback.onSubmit?_executeCallback(options.submit.callback.onSubmit,[node]):submitForm();_executeCallback(options.submit.callback.onAfterSubmit,[node])}return false})}function validateForm(){var e=true;$.each(node.find("["+_data.validation+"]:not([disabled]),["+_data.regex+"]:not([disabled])"),function(t,n){if(!validateInput(n)){e=false}});return e}function validateInput(e){var t=$(e).attr("name");if(!t){return false}var n=_getInputValue(e),r=t.replace(/]$/,"").split(/]\[|[[\]]/g),i=window.Validation.labels[t]||options.labels[t]||$(e).attr(_data.label)||r[r.length-1],s=$(e).attr(_data.validation),o=$(e).attr(_data.validationMessage),u=$(e).attr(_data.regex),a=!($(e).attr(_data.regexReverse)===undefined),f=$(e).attr(_data.regexMessage),l=false;if(s){s=_api._splitValidation(s)}if(s instanceof Array&&s.length>0){if(n===""&&$.inArray("OPTIONAL",s)!==-1){return true}$.each(s,function(e,r){if(l===true){return true}try{validateRule(n,r)}catch(s){if(o||!options.submit.settings.allErrors){l=true}s[0]=o||s[0];registerError(t,s[0].replace("$",i).replace("%",s[1]))}})}if(u){var c=_buildRegexFromString(u);if(!(c instanceof RegExp)){return true}try{validateRule(n,c,a)}catch(h){h[0]=f||h[0];registerError(t,h[0].replace("$",i))}}return!errors[t]||errors[t]instanceof Array&&errors[t].length===0}function validateRule(value,rule,reversed){if(rule instanceof RegExp){var isValid=rule.test(value);if(reversed){isValid=!isValid}if(!isValid){throw[options.messages["default"],""]}return}if(options.rules[rule]){if(!options.rules[rule].test(value)){throw[options.messages[rule],""]}return}var comparison=rule.match(options.rules.COMPARISON);if(!comparison||comparison.length!==4){return}var type=comparison[1],operator=comparison[2],compared=comparison[3],comparedValue;switch(type){case"L":if(isNaN(compared)){return false}else{if(!value||eval(value.length+operator+parseFloat(compared))===false){throw[options.messages[operator],compared]}}break;case"V":default:if(isNaN(compared)){comparedValue=node.find('[name="'+compared+'"]').val();if(!comparedValue){return false}if(!value||!eval('"'+encodeURIComponent(value)+'"'+operator+'"'+encodeURIComponent(comparedValue)+'"')){throw[options.messages[operator].replace(" characters",""),compared]}}else{if(!value||isNaN(value)||!eval(value+operator+parseFloat(compared))){throw[options.messages[operator].replace(" characters",""),compared]}}break}}function registerError(e,t){if(!errors[e]){errors[e]=[]}t=t.capitalize();var n=false;for(var r=0;r<errors[e].length;r++){if(errors[e][r]===t){n=true;break}}if(!n){errors[e].push(t)}}function displayOneError(e){var t,n,r,i,s='<div class="'+options.submit.settings.errorListClass+'" '+_data.errorList+"><ul></ul></div>",o,u;if(!errors.hasOwnProperty(e)){return false}t=node.find('[name="'+e+'"]');i=null;if(!t[0]){return false}o=t.attr(_data.group);if(o){u=node.find('[name="'+e+'"]');i=node.find('[id="'+o+'"]');if(i[0]){i.addClass(options.submit.settings.errorClass);r=i}}else{t.addClass(options.submit.settings.errorClass);if(options.submit.settings.inputContainer){t.parentsUntil(node,options.submit.settings.inputContainer).addClass(options.submit.settings.errorClass)}n=t.attr("id");if(n){i=node.find('label[for="'+n+'"]')[0]}if(!i){i=t.parentsUntil(node,"label")[0]}if(i){i=$(i);i.addClass(options.submit.settings.errorClass)}}if(options.submit.settings.display==="inline"){r=r||t.parent()}else if(options.submit.settings.display==="block"){r=node}if(options.submit.settings.display==="inline"&&r.find("["+_data.errorList+"]")[0]){return false}if(options.submit.settings.display==="inline"||options.submit.settings.display==="block"&&!r.find("["+_data.errorList+"]")[0]){if(options.submit.settings.insertion==="append"){r.append(s)}else if(options.submit.settings.insertion==="prepend"){r.prepend(s)}}for(var a=0;a<errors[e].length;a++){r.find("ul").append("<li>"+errors[e][a]+"</li>")}if(options.submit.settings.clear||options.dynamic.settings.trigger){if(o&&u){t=u}var f="coucou"+resetSuffix;if(options.submit.settings.clear){f+=" "+options.submit.settings.clear+resetSuffix}if(options.dynamic.settings.trigger){f+=" "+options.dynamic.settings.trigger+resetSuffix;if(options.dynamic.settings.trigger!=="focusout"){f+=" change"+resetSuffix+" paste"+resetSuffix}}t.unbind(f).on(f,function(e,t,n,r,i){return function(){if(i){if($(n).hasClass(options.submit.settings.errorClass)){resetOneError(e,t,n,r,i)}}else if($(t).hasClass(options.submit.settings.errorClass)){resetOneError(e,t,n,r)}}}(e,t,i,r,o))}if(options.submit.settings.scrollToError&&!window.Validation.hasScrolled){window.Validation.hasScrolled=true;var l=parseFloat(options.submit.settings.scrollToError.offset)||0,c=parseFloat(options.submit.settings.scrollToError.duration)||500,h=options.submit.settings.display==="block"?r:t;$("html, body").animate({scrollTop:h.offset().top+l},c)}}function displayErrors(){for(var e in errors){if(!errors.hasOwnProperty(e))continue;displayOneError(e)}}function resetOneError(e,t,n,r,i){delete errors[e];if(r){if(options.submit.settings.inputContainer){(i?n:t).parentsUntil(node,options.submit.settings.inputContainer).removeClass(options.submit.settings.errorClass)}n&&n.removeClass(options.submit.settings.errorClass);t.removeClass(options.submit.settings.errorClass);if(options.submit.settings.display==="inline"){r.find("["+_data.errorList+"]").remove()}}else{if(!t){t=node.find('[name="'+e+'"]');if(!t[0]){return false}}t.trigger("coucou"+resetSuffix)}}function resetErrors(){errors=[];window.Validation.hasScrolled=false;node.find("["+_data.errorList+"]").remove();node.find("."+options.submit.settings.errorClass).removeClass(options.submit.settings.errorClass)}function submitForm(){node[0].submit()}function destroy(){resetErrors();node.find("["+_data.validation+"],["+_data.regex+"]").off(delegateSuffix+" "+resetSuffix);node.find(options.submit.settings.button).off(delegateSuffix).on("click"+delegateSuffix,function(){$(this).closest("form")[0].submit()});return true}var errors=[],messages={},delegateSuffix=".vd",resetSuffix=".vr";window.Validation.hasScrolled=false;var _getInputValue=function(e){var t;switch($(e).attr("type")){case"checkbox":t=$(e).is(":checked")?1:"";break;case"radio":t=node.find('input[name="'+$(e).attr("name")+'"]:checked').val()||"";break;default:t=$(e).val();break}return t};var _typeWatch=function(){var e=0;return function(t,n){clearTimeout(e);e=setTimeout(t,n)}}();var _executeCallback=function(e,t){if(!e){return false}var n;if(typeof e==="function"){n=e}else if(typeof e==="string"||e instanceof Array){n=window;if(typeof e==="string"){e=[e,[]]}var r=e[0].split("."),i=e[1],s=true,o=0;while(o<r.length){if(typeof n!=="undefined"){n=n[r[o++]]}else{s=false;break}}if(!s||typeof n!=="function"){return false}}n.apply(this,$.merge(i||[],t?t:[]));return true};this.__construct=function(){extendOptions();extendRules();extendMessages();delegateDynamicValidation();delegateValidation()}();return{registerError:registerError,displayOneError:displayOneError,displayErrors:displayErrors,resetOneError:resetOneError,resetErrors:resetErrors,destroy:destroy}};$.fn.validate=$.validate=function(e){return _api.validate(this,e)};$.fn.addValidation=function(e){return _api.addValidation(this,e)};$.fn.removeValidation=function(e){return _api.removeValidation(this,e)};$.fn.addError=function(e){return _api.addError(this,e)};$.fn.removeError=function(e){return _api.removeError(this,e)};$.fn.alterValidationRules=$.alterValidationRules=function(e){if(!(e instanceof Array)){e=[e]}for(var t=0;t<e.length;t++){_api.alterValidationRules(e[t])}};var _api={_formatValidation:function(e){e=e.toString().replace(/\s/g,"");if(e.charAt(0)==="["&&e.charAt(e.length-1)==="]"){e=e.replace(/^\[|\]$/g,"")}return e},_splitValidation:function(e){var t=this._formatValidation(e).split(","),n;for(var r=0;r<t.length;r++){n=t[r];if(/^[a-z]+$/i.test(n)){t[r]=n.toUpperCase()}}return t},_joinValidation:function(e){return"["+e.join(", ")+"]"},validate:function(e,t){if(typeof e==="function"){if(!t.submit.settings.form){return}e=$(t.submit.settings.form);if(!e[0]||e[0].nodeName.toLowerCase()!=="form"){return}}else if(typeof e[0]==="undefined"){return}if(t==="destroy"){if(!window.Validation.form[e.selector]){return}window.Validation.form[e.selector].destroy();return}return e.each(function(){window.Validation.form[e.selector]=new Validation($(this),t)})},addValidation:function(e,t){var n=this;t=n._splitValidation(t);if(!t){return false}return e.each(function(){var e=$(this),r=e.attr(_data.validation),i=r&&r.length?n._splitValidation(r):[],s;for(var o=0;o<t.length;o++){s=n._formatValidation(t[o]);if($.inArray(s,i)===-1){i.push(s)}}if(i.length){e.attr(_data.validation,n._joinValidation(i))}})},removeValidation:function(e,t){var n=this;t=n._splitValidation(t);if(!t){return false}return e.each(function(){var e=$(this),r=e.attr(_data.validation),i=r&&r.length?n._splitValidation(r):[],s,o;if(!i.length){e.removeAttr(_data.validation);return true}for(var u=0;u<t.length;u++){s=n._formatValidation(t[u]);o=$.inArray(s,i);if(o!==-1){i.splice(o,1)}}if(!i.length){e.removeAttr(_data.validation);return true}e.attr(_data.validation,n._joinValidation(i))})},addError:function(e,t){if(!window.Validation.form[e.selector]){return false}if(typeof t!=="object"||Object.prototype.toString.call(t)!=="[object Object]"){return false}var n,r=true;for(var i in t){if(!t.hasOwnProperty(i)){continue}if(!(t[i]instanceof Array)){t[i]=[t[i]]}n=$(e.selector).find('[name="'+i+'"]');if(!n[0]){continue}if(r){window.Validation.hasScrolled=false;r=false}window.Validation.form[e.selector].resetOneError(i,n);for(var s=0;s<t[i].length;s++){if(typeof t[i][s]!=="string"){continue}window.Validation.form[e.selector].registerError(i,t[i][s])}window.Validation.form[e.selector].displayOneError(i)}},removeError:function(e,t){if(!window.Validation.form[e.selector]){return false}if(!t){window.Validation.form[e.selector].resetErrors();return false}if(typeof t==="object"&&Object.prototype.toString.call(t)!=="[object Array]"){return false}if(!(t instanceof Array)){t=[t]}var n;for(var r=0;r<t.length;r++){n=$(e.selector).find('[name="'+t[r]+'"]');if(!n[0]){continue}window.Validation.form[e.selector].resetOneError(t[r],n)}},alterValidationRules:function(e){if(!e.rule||!e.regex&&!e.message){return false}e.rule=e.rule.toUpperCase();if(e.regex){var t=_buildRegexFromString(e.regex);if(!(t instanceof RegExp)){return false}_rules[e.rule]=t}if(e.message){_messages[e.rule]=e.message}return true}};String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e,t){var n;if(this==null){throw new TypeError('"this" is null or not defined')}var r=Object(this);var i=r.length>>>0;if(i===0){return-1}var s=+t||0;if(Math.abs(s)===Infinity){s=0}if(s>=i){return-1}n=Math.max(s>=0?s:i-Math.abs(s),0);while(n<i){if(n in r&&r[n]===e){return n}n++}return-1}}})(window,document,window.jQuery)